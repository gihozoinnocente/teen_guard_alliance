<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resources - Kumenya App</title>
    <link rel="stylesheet" href="/CSS/index.css">
    <link rel="stylesheet" href="CSS/contact.css">
    <link rel="stylesheet" href="CSS/testimonial.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
      .resource-card {
          border: 1px solid #ddd;
          border-radius: 5px;
          padding: 15px;
          max-width: 600px;
          margin-top: 5%;
          margin-left: 2%;
          margin-bottom: 2%;
      }
      .resource-body {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
      }
      .read-more {
          color: blue;
          cursor: pointer;
          text-decoration: underline;
      }
      .read-less {
          color: blue;
          cursor: pointer;
          text-decoration: underline;
      }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo">
                <a href="#"><img src="./images/logo-color.png" width="90px" height="60px" alt=""></a>
            </div>
            <div class="navbar">
                <a href="index.html" id="homeLink">Home</a>
                <a href="#about" id="aboutLink">About us</a>
                <a href="#our_team" id="ourTeamLink">Our Team</a>
                <a href="#testimonial" id="testimonialLink">Testimonial</a>
                <a href="#contact" id="contactLink">Contact</a>
                <a href="resources.html" id="resourcesLink">Resources</a>
            </div>
            <div class="buttons">
                <a href="./Pages/login.html" class="login">Login</a>
                <a href="./Pages/signup.html" class="signup">Register</a>
                <i class="ri-menu-fill" id="menu-icon"></i>
            </div>
        </nav>
    </header>

    <main>
        <!-- Resources content -->
        <section>
            <h1>Resources</h1>
            <div id="resources-container"></div>
        </section>
    </main>

    <footer id="contact">
        <h2 style="text-align: center; margin-bottom: 10%; text-decoration: underline orange;">CONTACT US</h2>
        <div class="contact-details">
            <div class="left-side">
                <div class="item">
                    <img src="images/Envelope.svg" alt="Mail">
                    <p><a href=""> teenguardalliance@gmail.com</a></p>
                </div>
                <div class="item">
                    <img src="images/Phone.svg" alt="Phone">
                    <p>+250-783-742-810</p>
                </div>
                <div class="item">
                    <img src="images/Location.svg" alt="Location">
                    <p><a href="">Kigali, Bumbogo, ALU, KG11Av</a></p>
                </div>
            </div>
            <div class="form-box">
                <form action="#" method="post" class="contact-form" id="contactForm">
                    <label for="name">Name <span class="required">*</span></label><br>
                    <input type="text" id="name" name="name" required><br>
                    <label for="email">Email Address <span class="required">*</span></label><br>
                    <input type="email" id="email" name="email" required><br>
                    <label for="subject">Subject:</label><br>
                    <input type="text" id="subject" name="subject"><br>
                    <label for="message">Message <span class="required">*</span></label><br>
                    <textarea id="message" name="message" rows="4" required></textarea><br>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
        <p class="copy">&copy; 2024 Teen Guard Alliance. All rights reserved.</p>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
          fetch('http://localhost:3400/get_resources')
              .then(response => response.json())
              .then(data => {
                  const container = document.getElementById('resources-container');
                  container.innerHTML = data.map(resource => `
                      <div class="resource-card">
                          <h2>${resource.subject}</h2>
                          <h3>${resource.introduction}</h3>
                          <p class="resource-body" id="body-${resource.id}" data-full-body="${resource.body}">
                              ${resource.body.length > 100 ? resource.body.substring(0, 100) + '...' : resource.body}
                          </p>
                          ${resource.body.length > 100 ? 
                              `<span class="read-more" onclick="toggleReadMore(${resource.id})">Read more</span>` 
                              : ''}
                      </div>
                  `).join('');
              })
              .catch(error => console.error('Error fetching resources:', error));
      });

      function toggleReadMore(id) {
          const bodyElement = document.getElementById(`body-${id}`);
          const fullBody = bodyElement.getAttribute('data-full-body');
          bodyElement.textContent = fullBody;
          bodyElement.style.whiteSpace = 'normal';
          bodyElement.style.overflow = 'visible';
          bodyElement.style.textOverflow = 'clip';
          document.querySelector(`#body-${id} + .read-more`).textContent = 'Read less';
          document.querySelector(`#body-${id} + .read-more`).classList.remove('read-more');
          document.querySelector(`#body-${id} + .read-more`).classList.add('read-less');
          document.querySelector(`#body-${id} + .read-less`).setAttribute('onclick', `toggleReadLess(${id})`);
      }

      function toggleReadLess(id) {
          const bodyElement = document.getElementById(`body-${id}`);
          const fullBody = bodyElement.getAttribute('data-full-body');
          bodyElement.textContent = fullBody.substring(0, 100) + '...';
          bodyElement.style.whiteSpace = 'nowrap';
          bodyElement.style.overflow = 'hidden';
          bodyElement.style.textOverflow = 'ellipsis';
          document.querySelector(`#body-${id} + .read-less`).textContent = 'Read more';
          document.querySelector(`#body-${id} + .read-less`).classList.remove('read-less');
          document.querySelector(`#body-${id} + .read-less`).classList.add('read-more');
          document.querySelector(`#body-${id} + .read-more`).setAttribute('onclick', `toggleReadMore(${id})`);
      }
  </script>
</body>
</html>
